<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Messaging Using Socket IO</title>

</head>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io('ws://localhost:3000', { transports: ['websocket'] });
    function setUsername() {
        socket.emit('setUsername', document.getElementById('username').value);
    }
    var user;
    socket.on('userExists', function(data) {
       document.getElementById('error-container').innerHTML = data;
    });
    socket.on('userSet', function(data) {
        user = data.username;
        document.body.innerHTML = '<input type = "text" id = "message">\
         <button type = "button" name = "button" onclick = "sendMessage()">Send</button>\
         <div id = "message-container"></div>';
    });

    function sendMessage() {
        var msg = document.getElementById('message').value;
        if(msg) {
            socket.emit('msg', {message: msg, user: user});
        }
    }
  
    socket.on('newMsg', function(data) {
        if (user) {
            date = new Date;
            document.getElementById('message-container').innerHTML+= '<div><b>'+
                data.user +' : ' + '</b>' +' ' +data.message + '   ' + date +'</div'
        }
    });
  
    //socket.emit('clientEvent', 'This is a client Event');
  /*  socket.on('newclientconnect',function(data) {
         document.getElementById("client").innerHTML = '';
         document.write(data.description);
      });*/
</script>

<body>

<label>Username : </label>
<input type="text" id="username" name="username" placeholder="Enter username" autocomplete="off">
<button  onclick="setUsername()">Chat</button> 

<div  id="error-container">

</div>
<div  id="message-container">

</div>
</body>

</html>